{"version":3,"sources":["webpack:///./src/pages/index.js"],"names":["CENTER","IndexPage","useTracker","api","data","stats","countries","hasCountries","Array","isArray","length","dashboardStats","primary","label","value","cases","toLocaleString","secondary","casesPerOneMillion","deaths","deathsPerOneMillion","tests","testsPerOneMillion","active","critical","recovered","a","map","leafletElement","eachLayer","layer","options","name","removeLayer","geoJson","type","features","country","countryInfo","lat","lng","long","properties","geometry","coordinates","L","GeoJSON","pointToLayer","feature","latlng","updatedFormatted","casesString","updated","slice","Date","html","marker","icon","divIcon","className","riseOnHover","addTo","mapSettings","center","defaultBaseMap","zoom","mapEffect","pageName","i","key"],"mappings":"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","file":"component---src-pages-index-js-a145687caae0f13c8189.js","sourcesContent":["import React from 'react';\nimport { Helmet } from 'react-helmet';\nimport L from 'leaflet';\nimport { useTracker } from 'hooks';\nimport { Layout, Map } from 'components';\n\nconst LOCATION = {\n  lat: 0,\n  lng: 0\n};\nconst CENTER = [LOCATION.lat, LOCATION.lng];\nconst DEFAULT_ZOOM = 2;\n\nconst IndexPage = () => {\n  const { data: stats = {} } = useTracker({\n    api: 'all'\n  });\n\n  const { data: countries = [] } = useTracker({\n    api: 'countries'\n  });\n\n  const hasCountries = Array.isArray( countries ) && countries.length > 0;\n\n  const dashboardStats = [\n    {\n      primary: {\n        label: 'Total Cases',\n        value: stats ? stats?.cases.toLocaleString( 'en-US' ) : '-'\n      },\n      secondary: {\n        label: 'Per 1 Million',\n        value: stats ? stats?.casesPerOneMillion.toLocaleString( 'en-US' ) : '-'\n      }\n    },\n    {\n      primary: {\n        label: 'Total Deaths',\n        value: stats ? stats?.deaths.toLocaleString( 'en-US' ) : '-'\n      },\n      secondary: {\n        label: 'Per 1 Million',\n        value: stats ? stats?.deathsPerOneMillion.toLocaleString( 'en-US' ) : '-'\n      }\n    },\n    {\n      primary: {\n        label: 'Total Tests',\n        value: stats ? stats?.tests.toLocaleString( 'en-US' ) : '-'\n      },\n      secondary: {\n        label: 'Per 1 Million',\n        value: stats ? stats?.testsPerOneMillion.toLocaleString( 'en-US' ) : '-'\n      }\n    },\n    {\n      primary: {\n        label: 'Active Cases',\n        value: stats ? stats?.active.toLocaleString( 'en-US' ) : '-'\n      }\n      // secondary: {\n      //     label: 'Per 1 Million',\n      //     value: stats ? stats?.activePerOneMillion.toLocaleString( 'en-US' ) : '-',\n      // },\n    },\n    {\n      primary: {\n        label: 'Critical Cases',\n        value: stats ? stats?.critical.toLocaleString( 'en-US' ) : '-'\n      }\n      // secondary: {\n      //     label: 'Per 1 Million',\n      //     value: stats ? stats?.criticalPerOneMillion.toLocaleString( 'en-US' ) : '-',\n      // },\n    },\n    {\n      primary: {\n        label: 'Recovered Cases',\n        value: stats ? stats?.recovered.toLocaleString( 'en-US' ) : '-'\n      }\n      // secondary: {\n      //     label: 'Per 1 Million',\n      //     value: stats ? stats?.recoveredPerOneMillion.toLocaleString( 'en-US' ) : '-',\n      // },\n    }\n  ];\n\n  /**\n   * mapEffect\n   * @description Fires a callback once the page renders\n   * @example Here this is and example of being used to zoom in and set a popup on load\n   */\n\n  async function mapEffect({ leafletElement: map } = {}) {\n    if ( !hasCountries || !map ) return;\n\n    map.eachLayer(( layer ) => {\n      if ( layer?.options?.name === 'Mapbox' ) return;\n      map.removeLayer( layer );\n    });\n\n    const geoJson = {\n      type: 'FeatureCollection',\n      features: countries.map(( country = {}) => {\n        const { countryInfo = {} } = country;\n        const { lat, long: lng } = countryInfo;\n        return {\n          type: 'Feature',\n          properties: {\n            ...country\n          },\n          geometry: {\n            type: 'Point',\n            coordinates: [lng, lat]\n          }\n        };\n      })\n    };\n\n    const geoJsonLayers = new L.GeoJSON( geoJson, {\n      pointToLayer: ( feature = {}, latlng ) => {\n        const { properties = {} } = feature;\n        let updatedFormatted;\n        let casesString;\n\n        const { country, updated, cases, deaths, recovered } = properties;\n\n        casesString = `${cases}`;\n\n        if ( cases > 1000000 ) {\n          casesString = `${casesString.slice( 0, -6 )}M+`;\n        } else if ( cases > 1000 ) {\n          casesString = `${casesString.slice( 0, -3 )}K+`;\n        }\n        if ( updated ) {\n          updatedFormatted = new Date( updated ).toLocaleString();\n        }\n\n        const html = `\n                    <span class=\"icon-marker\">\n                        <span class=\"icon-marker-tooltip\">\n                        <h2>${country}</h2>\n                        <ul>\n                            <li><strong>Confirmed:</strong> ${cases.toLocaleString( 'en-US' )}</li>\n                            <li><strong>Deaths:</strong> ${deaths.toLocaleString( 'en-US' )}</li>\n                            <li><strong>Recovered:</strong> ${recovered.toLocaleString( 'en-US' )}</li>\n                            <!-- <li><strong>Last Update:</strong> ${updatedFormatted}</li> -->\n                        </ul>\n                        </span>\n                        ${casesString}\n                    </span>\n                    `;\n\n        return L.marker( latlng, {\n          icon: L.divIcon({\n            className: 'icon',\n            html\n          }),\n          riseOnHover: true\n        });\n      }\n    });\n\n    geoJsonLayers.addTo( map );\n  }\n\n  const mapSettings = {\n    center: CENTER,\n    defaultBaseMap: 'Mapbox',\n    zoom: DEFAULT_ZOOM,\n    mapEffect\n  };\n\n  return (\n    <Layout pageName=\"home\">\n      <Helmet>\n        <title>COVID-19 Dashboard</title>\n      </Helmet>\n\n      <div className=\"tracker\">\n        <Map {...mapSettings} />\n        <div className=\"tracker-stats\">\n          <ul>\n            { dashboardStats.map(({ primary = {}, secondary = {} }, i ) => {\n              return (\n                <li key={`Stat-${i}`} className=\"tracker-stat\">\n                  { primary.value && (\n                    <p className=\"tracker-stat-primary\">\n                      { primary.value }\n                      <strong>{ primary.label }</strong>\n                    </p>\n                  ) }\n                  { secondary.value && (\n                    <p className=\"tracker-stat-secondary\">\n                      { secondary.value }\n                      <strong>{ secondary.label }</strong>\n                    </p>\n                  ) }\n                </li>\n              );\n            }) }\n          </ul>\n        </div>\n        <div className=\"tracker-last-updated\">\n          <p>Last Updated: { stats ? new Date( stats?.updated ).toLocaleString( 'en-us' ) : '-' }</p>\n        </div>\n      </div>\n    </Layout>\n  );\n};\n\nexport default IndexPage;\n"],"sourceRoot":""}